(this.webpackJsonpbuilding_booking_users_frontend=this.webpackJsonpbuilding_booking_users_frontend||[]).push([[0],{41:function(e,t,n){},43:function(e,t,n){},93:function(e,t,n){"use strict";n.r(t);var i=n(4),a=n.n(i),r=n(15),o=n.n(r),c=(n(41),n(42),n(5)),s=(n(43),n(6)),d=n(3),l=function(e){var t=Object(i.useState)({}),n=Object(c.a)(t,2),a=n[0],r=n[1];return Object(d.jsx)("div",{className:"signup-modal",children:Object(d.jsxs)("div",{className:"signup-modal-content",children:[Object(d.jsx)("h1",{className:"login-header",children:"Sign Up"}),Object(d.jsxs)("form",{className:"login-form",children:[Object(d.jsx)("input",{placeholder:"Name",name:"name",value:a.name,onChange:function(e){return r(Object(s.a)(Object(s.a)({},a),{},{name:e.target.value}))}}),Object(d.jsx)("input",{placeholder:"username please",name:"username",value:a.username,onChange:function(e){return r(Object(s.a)(Object(s.a)({},a),{},{username:e.target.value}))}}),Object(d.jsx)("input",{type:"password",name:"password",value:a.password,onChange:function(e){return r(Object(s.a)(Object(s.a)({},a),{},{password:e.target.value}))},placeholder:"start typing your password"}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{onClick:function(t){t.preventDefault(),console.log(a),fetch("http://localhost:3000/users",{method:"POST",headers:{accept:"application/json","content-type":"application/json"},body:JSON.stringify({name:a.name,username:a.username,password:a.password})}).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch((function(e){return console.log(e)})),e.toggle(t)},children:"Sign Up"})})]})]})})},u=function(e){var t=Object(i.useState)({}),n=Object(c.a)(t,2),a=n[0],r=n[1],o=Object(i.useState)(!1),u=Object(c.a)(o,2),j=u[0],b=u[1],h=Object(i.useState)(""),g=Object(c.a)(h,2),m=g[0],O=g[1],p=function(e){e.preventDefault(),b(!j)};return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{className:"login-header",children:"Login"}),Object(d.jsxs)("form",{className:"login-form",children:[Object(d.jsx)("input",{placeholder:"username please",name:"username",value:a.username,onChange:function(e){return r(Object(s.a)(Object(s.a)({},a),{},{username:e.target.value}))}}),Object(d.jsx)("input",{type:"password",name:"password",value:a.password,onChange:function(e){return r(Object(s.a)(Object(s.a)({},a),{},{password:e.target.value}))},placeholder:"start typing your password"}),Object(d.jsx)("label",{className:"login-message",children:m}),Object(d.jsxs)("div",{children:[Object(d.jsx)("button",{onClick:function(t){t.preventDefault(),fetch("http://localhost:3000/users/".concat(a.username)).then((function(e){return e.json()})).then((function(t){t?t.password===a.password?(console.log("logged in"),e.setCurrentUser(t),O("")):O("Wrong password, try 123!"):O("No username found, try tsering!")}))},children:"Log In"}),Object(d.jsx)("button",{onClick:p,children:"Sign Up"})]})]}),j&&Object(d.jsx)(l,{toggle:p})]})},j=n(32),b=n.n(j),h=function(e){var t=Object(i.useState)(""),n=Object(c.a)(t,2),a=n[0],r=n[1],o=Object(i.useState)(0),s=Object(c.a)(o,2),l=s[0],u=s[1],j=function(t){var n={user_id:e.user.id,building_id:e.building.id,start_time:e.date.startDate,end_time:e.date.endDate,confirmed:t};e.bookBuilding(n,l),e.setBidBook(!1)};return Object(d.jsx)("div",{className:"signup-modal",children:Object(d.jsxs)("div",{className:"signup-modal-content",children:[Object(d.jsx)("h3",{children:"Bid Book This Building!"}),Object(d.jsx)("h4",{children:"This building is already booked, the good news is you can still bid book it!"}),Object(d.jsxs)("h4",{children:["Max Bid: ",e.building.max_piriority_point]}),Object(d.jsxs)("h4",{children:["Min Bid: ",e.building.min_piriority_point]}),Object(d.jsx)("label",{style:{color:"red"},children:a}),Object(d.jsx)("input",{type:"number",min:"0",max:e.user.piriority_point,onChange:function(e){return u(e.target.value)},value:l}),Object(d.jsxs)("div",{children:[Object(d.jsx)("button",{onClick:function(){var t=!1;l<e.building.min_piriority_point?r("Minimum bid is ".concat(e.building.min_piriority_point)):l>e.building.max_piriority_point?r("Minimum bid is ".concat(e.building.min_piriority_point,"!")):(e.building.max_piriority_point==l&&(t=!0),j(t))},children:"Bid Book"}),Object(d.jsx)("button",{onClick:function(){return e.setBidBook(!1)},children:"Go Back"})]})]})})},g=function(e){return Object(d.jsx)("div",{children:Object(d.jsxs)("h3",{children:["From: ",new Date(e.booking.start_time).toLocaleDateString(),"to: ",new Date(e.booking.end_time).toLocaleDateString()]})})},m=function(e){var t=Object(i.useState)(!1),n=Object(c.a)(t,2),a=n[0],r=n[1],o=Object(i.useState)({startDate:new Date,endDate:new Date}),l=Object(c.a)(o,2),u=l[0],j=l[1],m=Object(i.useState)(!1),O=Object(c.a)(m,2),p=O[0],f=O[1],x=Object(i.useState)(),v=Object(c.a)(x,2),w=v[0],D=v[1],y=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.currentUser.piriority_point-n;console.log(t),fetch("http://localhost:3000/bookings",{method:"POST",headers:{accept:"application/json","content-type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){t?fetch("http://localhost:3000/users/".concat(e.currentUser.id),{method:"PATCH",headers:{accept:"application/json","content-type":"application/json"},body:JSON.stringify({piriority_point:i})}).then((function(e){return e.json()})).then((function(t){t&&(e.setCurrentUser(t),console.log(t),window.alert("Your booking has confirmed and we will keep you updated"))})):window.alert("System Error")}))};return Object(d.jsxs)("div",{className:"building-container",children:[Object(d.jsx)("h2",{children:e.building.name}),Object(d.jsx)("img",{src:e.building.img_url}),Object(d.jsxs)("h3",{children:["Location: ",e.building.location]}),Object(d.jsx)("button",{onClick:function(){return r(!a)},children:e.myBuilding?"Cancel":"Book"}),a&&Object(d.jsxs)("div",{className:"date-container",children:[Object(d.jsx)("h3",{children:"From"}),Object(d.jsx)(b.a,{selected:u.startDate,onChange:function(e){return j(Object(s.a)(Object(s.a)({},u),{},{startDate:new Date(e)}))}}),Object(d.jsx)("h3",{children:"To"}),Object(d.jsx)(b.a,{selected:u.endDate,onChange:function(e){return j(Object(s.a)(Object(s.a)({},u),{},{endDate:new Date(e)}))}}),Object(d.jsx)("button",{onClick:function(t){return function(t){if(t.preventDefault(),console.log("clicked"),e.building.bookings.length>0){var n=e.building.bookings.find((function(e){if(new Date(e.start_time)<new Date(u.startDate)){if(new Date(e.end_time)>new Date(u.startDate)||new Date(e.end_time)>new Date(u.endDate))return e}else if(new Date(e.start_time)>new Date(u.startDate)&&(new Date(e.start_time)<new Date(u.endDate)||new Date(e.end_time)<new Date(u.endDate)))return e}));if(n)n.confirmed?window.alert("Already booked, try other date!"):(D(n),f(!0));else{var i=u.startDate-new Date<=864e5,a={user_id:e.currentUser.id,building_id:e.building.id,start_time:u.startDate,end_time:u.endDate,confirmed:i};y(a)}}else{var r=u.startDate-new Date<=864e5,o={user_id:e.currentUser.id,building_id:e.building.id,start_time:u.startDate,end_time:u.endDate,confirmed:r};y(o)}}(t)},children:"Confirm"})]}),e.myBuilding&&Object(d.jsx)("div",{children:e.building.bookings.map((function(e){return Object(d.jsx)(g,{booking:e})}))}),p&&Object(d.jsx)(h,{user:e.currentUser,building:e.building,setBidBook:f,booked:w,date:u,bookBuilding:y})]})};var O=function(){var e=Object(i.useState)({}),t=Object(c.a)(e,2),n=t[0],a=t[1],r=Object(i.useState)([]),o=Object(c.a)(r,2),s=o[0],l=o[1];return Object(i.useEffect)((function(){fetch("http://localhost:3000/buildings").then((function(e){return e.json()})).then((function(e){l(e)}))}),[]),Object(d.jsxs)("div",{className:"App",children:[!n.username&&Object(d.jsx)(u,{setCurrentUser:a}),n.username&&Object(d.jsxs)("div",{className:"main-container",children:[Object(d.jsxs)("h1",{children:["Hi, ",n.name,"!"]}),Object(d.jsxs)("h3",{children:["Available PPs: ",n.piriority_point]}),Object(d.jsx)("div",{children:function(){if(n.bookings.length>0){for(var e=[],t=0;t<n.bookings.length;t++)for(var i=0;i<s.length;i++)s[i].id===n.bookings[t].building_id&&(e.includes(s[i])||e.push(s[i]));return Object(d.jsxs)("div",{className:"my-building",children:[Object(d.jsx)("h1",{children:"My Bookings"}),Object(d.jsx)("div",{className:"building-card-container",children:e.map((function(e){return Object(d.jsx)(m,{myBuilding:!0,building:e},e.id)}))})]})}return Object(d.jsxs)("div",{className:"my-building",children:[Object(d.jsx)("h1",{children:"My Bookings"}),Object(d.jsx)("h3",{children:"You don't have any bookings! Book now from following list!"})]})}()}),Object(d.jsx)("div",{className:"building-card-container",children:s.map((function(e){return Object(d.jsx)(m,{building:e,myBuilding:!1,setCurrentUser:a,currentUser:n},e.id)}))})]})]})},p=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,100)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),i(e),a(e),r(e),o(e)}))};o.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(O,{})}),document.getElementById("root")),p()}},[[93,1,2]]]);
//# sourceMappingURL=main.b16ba6ea.chunk.js.map